<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Document</title><style>html,body{margin:0;padding:0;background:#000;overflow:hidden}canvas{position:absolute;left:0;top:0}</style></head><body><canvas id="highlight"></canvas><canvas id="focusRect"></canvas><canvas id="canvas"></canvas><script>!function(){const e=document,f=e.body;e.head;let i=innerWidth,l=innerHeight;function t(t){return e.getElementById(t)}const n=t("canvas"),o=n.getContext("2d");n.width=i,n.height=l;const r=t("highlight"),h=r.getContext("2d");r.width=i,r.height=l;const c=t("focusRect"),u=c.getContext("2d");c.width=i,c.height=l,o.font="14px monospace",o.fillStyle="#fff",h.fillStyle="#666",u.fillStyle="#fff";const g=o.measureText("a").width,a=[""];let d=0,v=0,s=0,p=0,w=0,x=Math.floor(l/17);Math.floor(i/g);let y=setTimeout(function(){}),b=!0,m=setTimeout(function(){});function T(){o.clearRect(0,0,i,l);for(var t=0,e=a.length;t<e;t++){if(w>t)t=w;else if(t>w+x)break;o.fillText(a[t],p/g,17*t+17-17*w)}o.fillText("ctxRedrawn",0,l),clearTimeout(m),m=setTimeout(function(){o.clearRect(0,l-17,100,17)},1e3/15)}function R(t){if(h.clearRect(0,0,i,l),void 0!==t)for(var e=0,n=(X=t).length;e<n;e++)h.fillRect(t[e].x,t[e].y,t[e].w,19)}function L(){u.fillRect(Math.round(d*g-p),17*v+6-17*w,1,15),y=setTimeout(M,600)}function M(){u.clearRect(Math.round(d*g-p),17*v+6-17*w,1,15),y=setTimeout(L,600)}function C(){u.clearRect(Math.round(d*g-p),17*v+6-17*w,1,15)}function k(){u.fillRect(Math.round(d*g-p),17*v+6-17*w,1,15),clearTimeout(y),y=setTimeout(M,600),b=!0}function E(){for(var t=X.length,e=0;e<t;e++){var n=X[e].x/g,i=w+X[e].y/17,l=X[e].w/g;a[i]=l<0?a[i].slice(0,n- -1*l)+a[i].slice(n):a[i].slice(0,n)+a[i].slice(n+l)}C(),v=Math.min(S[1],B[1]),d=S[1]===B[1]?Math.min(S[0],B[0]):(S[1]>B[1]?B:S)[0],1<t&&(a[v]=a[v]+a[v+1],2<t&&a.splice(v+1,t-2),a.splice(v+1,1))}function A(){0<X.length&&D()}function D(){X=[],R()}let X=[],S=[0,0],B=[0,0],Y=!1,j="e";const H={CTRL:!1},I={X:function(){if(0<X.length)return E(),D(),void T();1!==a.length?a.splice(v,1):a[v]="",T(),C(),d=0,v===a.length&&v--,k()},A:function(){var t=a.length;const e=[];for(var n=0;n<t;n++)e.push({x:0,y:17*n,w:a[n].length*g});C(),d=a[t-1].length,v=t-1,R(e),k()},C:function(){let t="";for(var e=0,n=X.length;e<n;e++){var i=X[e];if(i.w<0){t+=a[i.y/17].substr(i.x/g+i.w/g,i.x/g);break}if(e===n-1){t+=a[i.y/17].substr(i.x/g,i.w/g);break}t+=a[i.y/17].substr(i.x/g,i.w/g)+"\n"}navigator.clipboard.writeText(t)},V:function(){}};for(var O=0,U=Object.keys(I),V=U.length;O<V;O++)I[U[O].toLowerCase()]=I[U[O]];const W={ArrowLeft:function(){if(A(),(s=0)===d==!1)return C(),void d--;void 0===a[v-1]!=!0&&0<v==!0&&(C(),v--,w>v&&w<v+2&&(w--,T()),d=a[v].length)},ArrowRight:function(){if(A(),s=0,d>a[v].length-1==!1)return C(),void d++;void 0===a[v+1]!=!0&&v<a.length==!0&&(C(),v++,v>=x&&w+x<a.length&&(w++,T()),d=0)},Control:function(){H.CTRL=!0},ArrowUp:function(){if(A(),0===v==!0)return 0!==d&&C(),d=0,void(s=0);C(),v--,w>v&&w<v+2&&(w--,T()),a[v].length>s!=!0||s>d!=!0?a[v].length>s!=!1||s>d!=!0?d>a[v].length==!0&&(d>s==!0&&(s=d),d=a[v].length):d=a[v].length:d=s},ArrowDown:function(){if(A(),v===a.length-1==!0)return d!==a[v].length&&C(),d=a[v].length,void(s=a[v].length);C(),v++,v>=x&&w+x<a.length&&(w++,T()),a[v].length>s!=!0||s>d!=!0?a[v].length>s!=!1||s>d!=!0?d>a[v].length==!0&&(d>s==!0&&(s=d),d=a[v].length):d=a[v].length:d=s},Enter:function(){A(),a[v].length>d==!0?(a.splice(v+1,0,a[v].substr(d)),a[v]=a[v].substr(0,d)):a.splice(v+1,0,""),T(),C(),v++,d=0,v>=x&&(w++,T())},Backspace:function(){if(0<X.length)return E(),T(),void D();if(0!==d||0!==v){if(0===d==!0&&0<v==!0)return C(),v--,0<w&&(w--,T()),d=a[v].length,a[v]=a[v]+a[v+1],a.splice(v+1,1),void T();a[v]=a[v].substr(0,d-1)+a[v].substr(d),T(),C(),d--}},Delete:function(){if(0<X.length)return E(),T(),void D();if(d===a[v].length!=!0||v!==a.length-1){if(d===a[v].length==!0&&v<a.length-1==!0)return a[v]=a[v]+a[v+1],a.splice(v+1,1),0<w&&(w--,T()),void T();a[v]=a[v].substr(0,d)+a[v].substr(d+1),T()}},default:function(){1===j.length!=!1&&(0<X.length&&(E(),D()),a[v]=a[v].substr(0,d)+j+a[v].substr(d),C(),d++,T(),k())}};L(),e.addEventListener("keydown",function(t){j=t.key,!0!==H.CTRL||void 0===I[j]?void 0!==W[j]?(W[j](),k()):W.default():I[j]()}),e.addEventListener("keyup",function(t){"Control"===t.key&&(H.CTRL=!1)}),e.addEventListener("paste",function(t){const e=(t.clipboardData||clipboardData).getData("text"),n=e.split("\n");var i=v+n.length-1,t=1===n.length?d+n[0].length:n[n.length-1].length;a[v]=a[v]+n[0],a.splice(v+1,0,...n.splice(1,n.length-1)),C(),d=t,v=i,T(),k()}),e.addEventListener("mousemove",function(t){var e=Math.ceil(t.pageX/g),n=Math.floor(w+t.pageY/17);let i=e,l=n;if(i>a[v].length?i=a[v].length:i<0&&(i=0),l>a.length-1?l=a.length-1:l<0&&(l=0),!0===Y){B=[i>a[l].length?a[l].length:i,l];var o=S[0],r=S[1],h=B[0],c=B[1];if(C(),v=l,d=i,r===c)return R([{x:o*g,y:17*r,w:(h-o)*g}]),void k();{const s=[];if(r<c)for(var u=0;u<c-r+1;u++)0!==u?u!==c-r?s.push({x:0,y:17*(r+u),w:a[r+u].length*g}):s.push({x:0,y:17*c,w:h*g}):s.push({x:o*g,y:17*r,w:(a[r].length-o)*g});else for(u=0;u<r-c+1;u++)0!==u?u!==r-c?s.push({x:0,y:17*(c+u),w:a[c+u].length*g}):s.push({x:0,y:17*r,w:o*g}):s.push({x:h*g,y:17*c,w:(a[c].length-h)*g});R(s),k()}}void 0!==a[n]&&t.pageX<a[n].length*g?f.style.cursor="text":"text"===f.style.cursor&&(f.style.cursor="initial")}),e.addEventListener("mousedown",function(t){var e=Math.ceil(t.pageX/g),n=Math.floor(w+t.pageY/17);void 0!==a[n]&&t.pageX<a[n].length*g&&(Y=!0,S=[e,n])}),e.addEventListener("mouseup",function(){setTimeout(function(){Y=!1},1)}),e.addEventListener("click",function(){!0!==Y&&A()})}();</script></body></html>
